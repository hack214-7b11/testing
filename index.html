<!DOCTYPE html>
<html>
<head>
    <title>ZAP Security Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #333; text-align: center; }
        .section {
            background: #f9f9f9;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #007cba;
        }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover { background: #005a87; }
        button.danger { background: #dc3545; }
        button.danger:hover { background: #c82333; }
        button.success { background: #28a745; }
        button.success:hover { background: #218838; }
        .test-area {
            border: 1px dashed #ccc;
            padding: 10px;
            margin: 10px 0;
            background: white;
            min-height: 50px;
        }
        .results {
            background: white;
            border: 1px solid #ddd;
            padding: 10px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-item {
            padding: 5px;
            margin: 2px 0;
            border-left: 3px solid #6c757d;
        }
        .log-item.vulnerable { border-color: #dc3545; background: #ffe6e6; }
        .log-item.secure { border-color: #28a745; background: #e6ffe6; }
        .log-item.warning { border-color: #ffc107; background: #fff3cd; }
        .log-item.info { border-color: #007cba; background: #e6f3ff; }
        .status-bar {
            background: #333;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç ZAP Extension Security Test</h1>
        
        <div class="status-bar" id="statusBar">
            ZAP Status: Checking...
        </div>

        <!-- Quick Start -->
        <div class="section">
            <h2>üöÄ Quick Start</h2>
            <button class="success" onclick="runQuickTest()">Run Quick Security Test</button>
            <button onclick="runAllTests()">Run All Tests</button>
            <button class="danger" onclick="clearAll()">Clear All</button>
        </div>

        <!-- Environment Check -->
        <div class="section">
            <h2>üåê Environment Check</h2>
            <button onclick="checkEnvironment()">Check Environment</button>
            <div class="results" id="envResults">
                Click to check environment...
            </div>
        </div>

        <!-- Basic Recording Test -->
        <div class="section">
            <h2>‚ö° Basic Recording Test</h2>
            <button onclick="testRecording()">Test Basic Recording</button>
            <div class="test-area" id="basicTestArea">
                <p>Click these elements while ZAP is recording:</p>
                <button id="testBtn1">Test Button 1</button>
                <input id="testInput1" placeholder="Test input">
            </div>
            <div class="results" id="basicResults"></div>
        </div>

        <!-- XSS Tests -->
        <div class="section">
            <h2>üõ°Ô∏è XSS Vulnerability Tests</h2>
            <button class="danger" onclick="createXSSTests()">Create XSS Test Elements</button>
            <button onclick="testXSSTests()">Test XSS Elements</button>
            <div class="test-area" id="xssTestArea"></div>
            <div class="results" id="xssResults"></div>
        </div>

        <!-- Path Traversal Tests -->
        <div class="section">
            <h2>üìÅ Path Traversal Tests</h2>
            <button class="danger" onclick="createPathTests()">Create Path Tests</button>
            <div class="test-area" id="pathTestArea"></div>
            <div class="results" id="pathResults"></div>
        </div>

        <!-- Results Summary -->
        <div class="section">
            <h2>üìä Test Summary</h2>
            <button onclick="showSummary()">Show Summary</button>
            <div class="results" id="summaryResults"></div>
        </div>
    </div>

    <script>
        // Simple logging function
        function log(sectionId, type, message) {
            const section = document.getElementById(sectionId);
            const logItem = document.createElement('div');
            logItem.className = 'log-item ' + type;
            logItem.innerHTML = '[' + new Date().toLocaleTimeString() + '] ' + message;
            section.appendChild(logItem);
            section.scrollTop = section.scrollHeight;
        }

        // Clear logs
        function clearLogs(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) section.innerHTML = '';
        }

        // Update status bar
        function updateStatus() {
            const statusBar = document.getElementById('statusBar');
            const zapDiv = document.getElementById('ZAP-floating-div');
            
            if (zapDiv && zapDiv.style.display !== 'none') {
                statusBar.innerHTML = 'ZAP Status: ‚úÖ Recording Active';
                statusBar.style.background = '#28a745';
            } else {
                statusBar.innerHTML = 'ZAP Status: ‚ùå Not Recording - Start ZAP Extension';
                statusBar.style.background = '#dc3545';
            }
        }

        // Check environment
        function checkEnvironment() {
            clearLogs('envResults');
            log('envResults', 'info', 'Checking browser environment...');
            
            // Basic checks
            const checks = [
                { name: 'Browser', value: navigator.userAgent },
                { name: 'Chrome API', value: typeof chrome !== 'undefined' ? 'Available' : 'Not Available' },
                { name: 'ZAP Div', value: document.getElementById('ZAP-floating-div') ? 'Found' : 'Not Found' }
            ];
            
            checks.forEach(check => {
                log('envResults', 'info', `${check.name}: ${check.value}`);
            });
            
            updateStatus();
        }

        // Test basic recording
        function testRecording() {
            clearLogs('basicResults');
            log('basicResults', 'info', 'Testing basic recording functionality...');
            
            // Add test button
            const testArea = document.getElementById('basicTestArea');
            const testBtn = document.createElement('button');
            testBtn.textContent = 'Dynamic Test Button';
            testBtn.onclick = function() {
                log('basicResults', 'secure', '‚úì Dynamic button clicked');
            };
            testArea.appendChild(testBtn);
            
            // Add test input
            const testInput = document.createElement('input');
            testInput.placeholder = 'Dynamic test input';
            testInput.onchange = function(e) {
                log('basicResults', 'secure', `‚úì Input changed: ${e.target.value}`);
            };
            testArea.appendChild(testInput);
            
            log('basicResults', 'info', '‚úÖ Added test elements. Click them while ZAP is recording.');
        }

        // Create XSS tests
        function createXSSTests() {
            clearLogs('xssResults');
            const testArea = document.getElementById('xssTestArea');
            testArea.innerHTML = '<p>XSS Test Elements:</p>';
            
            const xssTests = [
                { id: 'xss1', text: 'Button with <script> tag', payload: '<script>alert("xss")</script>' },
                { id: 'xss2', text: 'Button with onerror', payload: '<img src=x onerror=alert(1)>' },
                { id: 'xss3', text: 'Button with javascript:', payload: 'javascript:alert("js")' }
            ];
            
            xssTests.forEach(test => {
                const btn = document.createElement('button');
                btn.textContent = test.text;
                btn.className = 'danger';
                btn.onclick = function() {
                    log('xssResults', 'vulnerable', `‚ò†Ô∏è Clicked: ${test.payload}`);
                };
                testArea.appendChild(btn);
                testArea.appendChild(document.createElement('br'));
            });
            
            log('xssResults', 'info', '‚úÖ Created XSS test elements. Click them to test.');
        }

        // Test XSS elements automatically
        function testXSSTests() {
            const buttons = document.querySelectorAll('#xssTestArea button');
            log('xssResults', 'info', `Testing ${buttons.length} XSS elements...`);
            
            buttons.forEach((btn, index) => {
                setTimeout(() => {
                    btn.click();
                }, index * 1000);
            });
        }

        // Create path traversal tests
        function createPathTests() {
            clearLogs('pathResults');
            const testArea = document.getElementById('pathTestArea');
            testArea.innerHTML = '<p>Path Traversal Tests:</p>';
            
            const pathTests = [
                { text: '../../etc/passwd', desc: 'Unix path traversal' },
                { text: '..\\..\\windows\\system32', desc: 'Windows path traversal' },
                { text: '%2e%2e%2fetc%2fpasswd', desc: 'URL encoded path' }
            ];
            
            pathTests.forEach(test => {
                const btn = document.createElement('button');
                btn.textContent = test.desc + ': ' + test.text;
                btn.className = 'danger';
                btn.onclick = function() {
                    log('pathResults', 'vulnerable', `üìÅ Path traversal: ${test.text}`);
                };
                testArea.appendChild(btn);
                testArea.appendChild(document.createElement('br'));
            });
            
            log('pathResults', 'info', '‚úÖ Created path traversal tests.');
        }

        // Quick test
        function runQuickTest() {
            clearAll();
            log('envResults', 'info', 'üöÄ Starting quick security test...');
            
            setTimeout(() => {
                checkEnvironment();
            }, 500);
            
            setTimeout(() => {
                testRecording();
            }, 1500);
            
            setTimeout(() => {
                createXSSTests();
            }, 2500);
            
            setTimeout(() => {
                createPathTests();
            }, 3500);
            
            setTimeout(() => {
                log('summaryResults', 'info', '‚úÖ Quick test completed!');
                log('summaryResults', 'info', 'üí° Now: 1) Start ZAP recording 2) Click all test elements 3) Stop recording 4) Check ZEST script');
            }, 4500);
        }

        // Run all tests
        function runAllTests() {
            runQuickTest();
        }

        // Show summary
        function showSummary() {
            clearLogs('summaryResults');
            log('summaryResults', 'info', 'üìä Security Test Summary');
            log('summaryResults', 'info', 'Tests completed: Environment, Basic Recording, XSS, Path Traversal');
            log('summaryResults', 'warning', '‚ö†Ô∏è Remember to check the ZEST script for malicious content after recording');
        }

        // Clear all
        function clearAll() {
            const sections = ['envResults', 'basicResults', 'xssResults', 'pathResults', 'summaryResults'];
            sections.forEach(section => clearLogs(section));
            
            const testAreas = ['basicTestArea', 'xssTestArea', 'pathTestArea'];
            testAreas.forEach(area => {
                const element = document.getElementById(area);
                if (element) {
                    element.innerHTML = '<p>Test elements will appear here...</p>';
                }
            });
            
            log('envResults', 'info', 'üßπ All tests cleared. Ready for new test session.');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            log('envResults', 'info', 'üîç ZAP Security Test Suite Ready');
            updateStatus();
            setInterval(updateStatus, 3000);
        });
    </script>
</body>
</html>